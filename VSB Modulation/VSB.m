function VSB
%00:E0:4C:7A:1D:3F


f1=300;
f2=500;
f3=700;
f4=900;

fc=10000;
fs=48000;
Ac=1;
A1=1;A2=1;A3=1;A4=1;
%
t=0:1/fs:0.05;

x1=A1*cos(f1*2*pi*t);
x2=A2*cos(f2*2*pi*t);
x3=A3*cos(f3*2*pi*t);
x4=A4*cos(f4*2*pi*t);
xc=Ac*cos(fc*2*pi*t);
%
xtest=0.5*A1*Ac*(0.65*cos((f1+fc)*2*pi*t)+cos((fc-f1)*2*pi*t));

%x=x1+x2+x3+x4;
x=x1;
xdsb=x.*xc;

%tinh toan cac gia tri de ve
N=length(t);
T=1/fs;
f = -1/(2*T):1/(N*T):1/(2*T)-1/(N*T);
%-------------------------

%ve pho tan so
X=fft(xdsb);
Xshft = fftshift(X);

%Tinh toan VSB

%bo loc fp1=9200 fc1=10000 fc2=14000 fp3=16000
%BP= [-0.01133347149212,  0.03809929228187,  0.01240055977733, -0.01812656078078, 0.002687343224998,  0.00817123034994,-0.009987872810042,  0.01425552413945,   0.008958326454405, -0.03454014288773, 0.002077429853068,  0.03743479089178,    -0.0144085020338, -0.01597023082927,  0.01487125663436, -0.02096185559307,   0.003137647238691,  0.05145682179159,  -0.0305201642455, -0.05404128764316,    0.04376346035352,  0.02294074151834,  -0.0185109629841,  0.02574630162958,   -0.05275219706419, -0.06261462175633,   0.1507210807734,  0.06364439686961,    -0.2360438857275, -0.02660007645354,   0.2698799040951, -0.02660007645354,    -0.2360438857275,  0.06364439686961,   0.1507210807734, -0.06261462175633,   -0.05275219706419,  0.02574630162958,  -0.0185109629841,  0.02294074151834,    0.04376346035352, -0.05404128764316,  -0.0305201642455,  0.05145682179159,   0.003137647238691, -0.02096185559307,  0.01487125663436, -0.01597023082927,    -0.0144085020338,  0.03743479089178, 0.002077429853068, -0.03454014288773,   0.008958326454405,  0.01425552413945,-0.009987872810042,  0.00817123034994,   0.002687343224998, -0.01812656078078,  0.01240055977733,  0.03809929228187,   -0.01133347149212];

%bo loc fp1=8800 fc1=10500 fc2=14000 fp3=16000
BP = [  0.003328613726187,  0.01277565476843,-0.006889886510367, -0.01038375900576,   0.006406997316566, 0.006307479861468,-0.001273491096753,  0.00394481867316,   -0.01060411273198, -0.01548091096898,   0.0248241400287,  0.02136108927668,   -0.03153133001427, -0.01650565168387,  0.01901677343114, 0.001483405418843,    0.01977237526497,  0.01673720551266, -0.08138267848926, -0.02828720185431,     0.1505586932499,   0.0261271451249,   -0.205246046226, -0.01055095485017,     0.2260399041025, -0.01055095485017,   -0.205246046226,   0.0261271451249,     0.1505586932499, -0.02828720185431, -0.08138267848926,  0.01673720551266,    0.01977237526497, 0.001483405418843,  0.01901677343114, -0.01650565168387,   -0.03153133001427,  0.02136108927668,   0.0248241400287, -0.01548091096898,   -0.01060411273198,  0.00394481867316,-0.001273491096753, 0.006307479861468,   0.006406997316566, -0.01038375900576,-0.006889886510367,  0.01277565476843,   0.003328613726187];
%Bo loc chinh thuc

%BP=[   -0.03453060434098,  0.03301323433592,  0.03110949439603, -0.03430580428316,   -0.02368853742371,  0.03804959896227,   0.0194415573879, -0.01776971752281,   -0.01178462972745, -0.00808719573604,  0.01667523212683,  0.03329370252939,   -0.02197431306932, -0.03618220924457,  0.01886334104568,   0.0167646269585,    0.01186586687266,  0.01717924463106, -0.07152066421586, -0.04258690246139,     0.1481502363508,  0.04404898169083,  -0.2123032382671, -0.01826029596953,     0.2378291486802, -0.01826029596953,  -0.2123032382671,  0.04404898169083,     0.1481502363508, -0.04258690246139, -0.07152066421586,  0.01717924463106,    0.01186586687266,   0.0167646269585,  0.01886334104568, -0.03618220924457,   -0.02197431306932,  0.03329370252939,  0.01667523212683, -0.00808719573604,   -0.01178462972745, -0.01776971752281,   0.0194415573879,  0.03804959896227,   -0.02368853742371, -0.03430580428316,  0.03110949439603,  0.03301323433592,   -0.03453060434098]
   
   
   
xvsb=conv(xdsb,BP);
%xvsb=xvsb(25:505);                   %loai phan khong stable cua bo loc

xvsb=xvsb(25:2425);

Xvsb=fft(xvsb);

%figure
%plot(xtest);


%==========================================================================
%======
%thu nghiem t inh tich chap kieu khac.

%x=1;
%n=19; %do dai mau

%xtemp=xdsb(x:x+n);
%x=x+n;
%xvsbtemp=conv(xtemp,BP);
%xvsb2=xvsbtemp;

%while(x<length(xdsb)-n)
    
 %       xtemp = xdsb(x:x+n);
  %      x=x+n+1;
%
 %       xvsbtemp=conv(xtemp,BP);

%        xvsb2(length(xvsb2)-47: length(xvsb2))=xvsbtemp(1:48)+xvsb2(length(xvsb2)-47: length(xvsb2));
 %       xvsb2=[xvsb xvsbtemp(49:68)];
  %      clear xtemp
%end


%Xvsb=fft(xvsb);
%subplot(3,2,5);plot(xvsb);
%title('Dieu che VSB2');

%figure
%plot(xtest);


%subplot(3,2,6); plot(f,abs(fftshift(Xvsb)));
%title('Pho tan so VSB2');
%xlim([0 12000])

%====================================================================


%ve do thi ra
plot(x);
title('Dang song Ngo vao');
xlabel('Discrete time(n)'),ylabel('Amplitute(V)'),
ylim([-4 4])
figure
plot(xdsb);
title('Dang song khi dieu che DSB');
xlabel('Discrete time(n)'),ylabel('Amplitute(V)'),
xlim([0 450])
figure
plot(f,abs(Xshft));
title('Pho tan so DSB');
xlabel('Frequency(Hz)'),ylabel('|y|'),
xlim([000 12000])
figure
plot(xvsb);
xlabel('Discrete time(n)'),ylabel('Amplitute(V)'),
title('Dang song khi dieu che VSB');
xlim([0 450])
figure
plot(f,abs(fftshift(Xvsb)));
title('Pho tan so VSB');
xlabel('Frequency(Hz)'),ylabel('|y|'),
xlim([000 12000])
end










