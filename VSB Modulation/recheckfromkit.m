vsb=[];
x=[];
N=1001;
id = fopen('E:\Duy\My Projects\0 Hoc ki 8\Xu li tinh hieu tuong tu va so\do an dcm\Input\vsb.bin','rb');   
temp = fread(id,N,'int16');
fclose(id); 
vsb = temp';

id = fopen('E:\Duy\My Projects\0 Hoc ki 8\Xu li tinh hieu tuong tu va so\do an dcm\Input\x.bin','rb');   
temp = fread(id,N,'int16');
fclose(id); 
x = temp';

BP = [  0.003328613726187,  0.01277565476843,-0.006889886510367, -0.01038375900576,   0.006406997316566, 0.006307479861468,-0.001273491096753,  0.00394481867316,   -0.01060411273198, -0.01548091096898,   0.0248241400287,  0.02136108927668,   -0.03153133001427, -0.01650565168387,  0.01901677343114, 0.001483405418843,    0.01977237526497,  0.01673720551266, -0.08138267848926, -0.02828720185431,     0.1505586932499,   0.0261271451249,   -0.205246046226, -0.01055095485017,     0.2260399041025, -0.01055095485017,   -0.205246046226,   0.0261271451249,     0.1505586932499, -0.02828720185431, -0.08138267848926,  0.01673720551266,    0.01977237526497, 0.001483405418843,  0.01901677343114, -0.01650565168387,   -0.03153133001427,  0.02136108927668,   0.0248241400287, -0.01548091096898,   -0.01060411273198,  0.00394481867316,-0.001273491096753, 0.006307479861468,   0.006406997316566, -0.01038375900576,-0.006889886510367,  0.01277565476843,   0.003328613726187];

%BP=[   -0.03453060434098,  0.03301323433592,  0.03110949439603, -0.03430580428316,   -0.02368853742371,  0.03804959896227,   0.0194415573879, -0.01776971752281,   -0.01178462972745, -0.00808719573604,  0.01667523212683,  0.03329370252939,   -0.02197431306932, -0.03618220924457,  0.01886334104568,   0.0167646269585,    0.01186586687266,  0.01717924463106, -0.07152066421586, -0.04258690246139,     0.1481502363508,  0.04404898169083,  -0.2123032382671, -0.01826029596953,     0.2378291486802, -0.01826029596953,  -0.2123032382671,  0.04404898169083,     0.1481502363508, -0.04258690246139, -0.07152066421586,  0.01717924463106,    0.01186586687266,   0.0167646269585,  0.01886334104568, -0.03618220924457,   -0.02197431306932,  0.03329370252939,  0.01667523212683, -0.00808719573604,   -0.01178462972745, -0.01776971752281,   0.0194415573879,  0.03804959896227,   -0.02368853742371, -0.03430580428316,  0.03110949439603,  0.03301323433592,   -0.03453060434098];
   

fc=10000;
Ac=1;
fs=48000;
t=0:1/fs:0.07;
xc=Ac*cos(fc*2*pi*t);
xc=xc(1:1000);


xdsb=x.*xc;
xvsb=conv(xdsb,BP);
xvsb=1.4* xvsb(1:1000);



X=fft(xvsb);
Xshft = fftshift(X);

T=1/fs;
f = -1/(2*T):1/(N*T):1/(2*T)-2/(N*T);

subplot(3,2,6); plot(f,abs(Xshft));
title('Pho tan so VSB lam bang Matlab');
xlabel('Frequency(Hz)'),ylabel('|y|'),
xlim([8000 12000])

X=fft(vsb);
Xshft = fftshift(X);

f = -1/(2*T):1/(N*T):1/(2*T)-2/(N*T);

subplot(3,2,4); plot(f,abs(Xshft));
title('Pho tan so VSB thuc hien tren kit');
xlabel('Frequency(Hz)'),ylabel('|y|'),
xlim([8000 12000])

subplot(3,2,1); plot(x);
title('Dang ngo vao lay tu Kit');
xlabel('Thoi gian roi rac n'),ylabel('Amplitute'),
ylim([-6000 6000])

subplot(3,2,3); plot(vsb);
title('Dang song VSB tu KIT');
xlabel('Thoi gian roi rac n'),ylabel('Amplitute'),
ylim([-6000 6000]);

subplot(3,2,5); plot(xvsb);
title('Dang song VSB xu li bang Matlab');
xlabel('Thoi gian roi rac n'),ylabel('Amplitute'),
ylim([-6000 6000]);
